
> pinnlo-v2@0.1.0 dev
> next dev -p 3000

  ‚ñ≤ Next.js 14.2.30
  - Local:        http://localhost:3000
  - Environments: .env.local

 ‚úì Starting...
 ‚úì Ready in 1197ms
 ‚óã Compiling /_not-found ...
<w> [webpack.cache.PackFileCacheStrategy] Serializing big strings (100kiB) impacts deserialization performance (consider using Buffer instead and decode when needed)
 ‚úì Compiled /_not-found in 3.6s (802 modules)
Supabase URL: Set
Supabase Anon Key: Set
 ‚ö† Fast Refresh had to perform a full reload due to a runtime error.
 GET /_next/static/webpack/7df0fa1f849bc0f0.webpack.hot-update.json 404 in 3913ms
 ‚úì Compiled in 308ms (317 modules)
 ‚ö† Fast Refresh had to perform a full reload due to a runtime error.
 GET /_next/static/webpack/7df0fa1f849bc0f0.webpack.hot-update.json 404 in 23ms
 ‚óã Compiling / ...
 ‚úì Compiled / in 1431ms (1266 modules)
Supabase URL: Set
Supabase Anon Key: Set
Failed to load agent registry: ReferenceError: localStorage is not defined
    at AgentRegistry.loadFromStorage (webpack-internal:///(ssr)/./src/lib/agentRegistry.ts:135:28)
    at new AgentRegistry (webpack-internal:///(ssr)/./src/lib/agentRegistry.ts:129:14)
    at eval (webpack-internal:///(ssr)/./src/lib/agentRegistry.ts:238:23)
    at (ssr)/./src/lib/agentRegistry.ts (/Users/matthewfitzpatrick/pinnlo-v2/.next/server/app/page.js:1436:1)
    at __webpack_require__ (/Users/matthewfitzpatrick/pinnlo-v2/.next/server/webpack-runtime.js:33:43)
    at eval (webpack-internal:///(ssr)/./src/components/development-bank-v2/AgentsSection.tsx:13:76)
    at (ssr)/./src/components/development-bank-v2/AgentsSection.tsx (/Users/matthewfitzpatrick/pinnlo-v2/.next/server/app/page.js:875:1)
    at __webpack_require__ (/Users/matthewfitzpatrick/pinnlo-v2/.next/server/webpack-runtime.js:33:43)
    at eval (webpack-internal:///(ssr)/./src/components/development-bank-v2/DevelopmentBank.tsx:26:72)
    at (ssr)/./src/components/development-bank-v2/DevelopmentBank.tsx (/Users/matthewfitzpatrick/pinnlo-v2/.next/server/app/page.js:886:1)
    at __webpack_require__ (/Users/matthewfitzpatrick/pinnlo-v2/.next/server/webpack-runtime.js:33:43)
    at eval (webpack-internal:///(ssr)/./src/components/development-bank-v2/DevelopmentBankModal.tsx:12:74)
    at (ssr)/./src/components/development-bank-v2/DevelopmentBankModal.tsx (/Users/matthewfitzpatrick/pinnlo-v2/.next/server/app/page.js:897:1)
    at __webpack_require__ (/Users/matthewfitzpatrick/pinnlo-v2/.next/server/webpack-runtime.js:33:43)
    at eval (webpack-internal:///(ssr)/./src/components/Header.tsx:17:110)
    at (ssr)/./src/components/Header.tsx (/Users/matthewfitzpatrick/pinnlo-v2/.next/server/app/page.js:270:1)
    at __webpack_require__ (/Users/matthewfitzpatrick/pinnlo-v2/.next/server/webpack-runtime.js:33:43)
    at eval (webpack-internal:///(ssr)/./src/app/page.tsx:7:76)
    at (ssr)/./src/app/page.tsx (/Users/matthewfitzpatrick/pinnlo-v2/.next/server/app/page.js:248:1)
    at Object.__webpack_require__ [as require] (/Users/matthewfitzpatrick/pinnlo-v2/.next/server/webpack-runtime.js:33:43)
    at require (/Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/compiled/next-server/app-page.runtime.dev.js:39:20088)
    at u (/Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/compiled/next-server/app-page.runtime.dev.js:35:97670)
    at /Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/compiled/next-server/app-page.runtime.dev.js:35:113239
    at /Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/compiled/next-server/app-page.runtime.dev.js:35:113326
    at /Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/compiled/next-server/app-page.runtime.dev.js:35:113486
    at /Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/compiled/next-server/app-page.runtime.dev.js:35:115236
    at t (/Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/compiled/next-server/app-page.runtime.dev.js:35:115459)
    at runNextTicks (node:internal/process/task_queues:65:5)
    at listOnTimeout (node:internal/timers:549:9)
    at process.processTimers (node:internal/timers:523:7)
üèóÔ∏è DevelopmentBankModal Debug:
- Modal isOpen: false
- Strategies loaded: 0
- Selected strategy: None
- Loading: true
üè¶ StrategyBankModal Debug:
- Modal isOpen: false
- Strategies loaded: 0
- Selected strategy: None
- Loading: true
 GET / 200 in 1587ms
 GET /_next/static/webpack/7df0fa1f849bc0f0.webpack.hot-update.json 404 in 144ms
 ‚ö† Fast Refresh had to perform a full reload due to a runtime error.
Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.
 GET /.well-known/appspecific/com.chrome.devtools.json 404 in 18ms
Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.
Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.
 ‚úì Compiled /api/users in 428ms (765 modules)
 POST /api/users 200 in 753ms
 POST /api/users 200 in 785ms
 ‚úì Compiled in 418ms (1240 modules)
 ‚úì Compiled in 266ms (1240 modules)
Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.
 ‚úì Compiled /api/mcp/invoke in 234ms (763 modules)
MCP invoke error: SyntaxError: Unexpected token '<', "<!DOCTYPE "... is not valid JSON
    at JSON.parse (<anonymous>)
    at parseJSONFromBytes (node:internal/deps/undici/undici:5738:19)
    at successSteps (node:internal/deps/undici/undici:5719:27)
    at fullyReadBody (node:internal/deps/undici/undici:4609:9)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async consumeBody (node:internal/deps/undici/undici:5728:7)
    at async POST (webpack-internal:///(rsc)/./src/app/api/mcp/invoke/route.ts:38:27)
    at async /Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/matthewfitzpatrick/pinnlo-v2/node_modules/next/dist/server/lib/start-server.js:141:13)
 POST /api/mcp/invoke 500 in 490ms
Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.
 ‚úì Compiled /api/ai/edit-mode/generate in 303ms (763 modules)
=== Edit Mode Generate API Called ===
Auth check: { user: '900903ff-4a27-4b57-b82b-73a0bb57d776', authError: undefined }
Request body: {
  cardId: '652f1446-ef3e-4209-b093-d34cc532930a',
  blueprintType: 'stakeholder-intelligence',
  cardTitle: 'New Intelligence Card',
  strategyId: '6',
  hasExistingFields: true
}
=== generateFieldsWithProgress START ===
Args: {
  cardId: '652f1446-ef3e-4209-b093-d34cc532930a',
  blueprintType: 'stakeholder-intelligence',
  cardTitle: 'New Intelligence Card',
  strategyId: '6',
  userId: '900903ff-4a27-4b57-b82b-73a0bb57d776',
  existingFields: {
    id: '652f1446-ef3e-4209-b093-d34cc532930a',
    user_id: '900903ff-4a27-4b57-b82b-73a0bb57d776',
    category: 'stakeholder',
    title: 'New Intelligence Card',
    summary: 'Click to edit this card',
    intelligence_content: '',
    key_findings: [],
    source_reference: '',
    date_accessed: null,
    credibility_score: 5,
    relevance_score: 5,
    relevant_blueprint_pages: [],
    strategic_implications: '',
    recommended_actions: '',
    tags: [],
    status: 'active',
    created_at: '2025-07-16T13:34:10.78862+00:00',
    updated_at: '2025-07-16T13:34:10.78862+00:00',
    cardType: 'stakeholder-intelligence',
    card_type: 'stakeholder-intelligence',
    description: 'Click to edit this card',
    relationships: [],
    strategicAlignment: '',
    createdDate: '2025-07-16T13:34:10.78862+00:00',
    lastModified: '2025-07-16T13:34:10.78862+00:00',
    creator: '',
    owner: '',
    priority: 'Medium',
    confidenceLevel: 'Medium',
    priorityRationale: '',
    confidenceRationale: ''
  }
}
Calling MCP URL: http://localhost:3001/api/tools/generate_edit_mode_content
generateFieldsWithProgress error: TypeError: fetch failed
    at node:internal/deps/undici/undici:13510:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateFieldsWithProgress (webpack-internal:///(rsc)/./src/app/api/ai/edit-mode/generate/route.ts:121:29) {
  [cause]: AggregateError [ECONNREFUSED]: 
      at internalConnectMultiple (node:net:1139:18)
      at afterConnectMultiple (node:net:1714:7)
      at TCPConnectWrap.callbackTrampoline (node:internal/async_hooks:130:17) {
    code: 'ECONNREFUSED',
    [errors]: [ [Error], [Error] ]
  }
}
Generation error: TypeError: fetch failed
    at node:internal/deps/undici/undici:13510:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateFieldsWithProgress (webpack-internal:///(rsc)/./src/app/api/ai/edit-mode/generate/route.ts:121:29) {
  [cause]: AggregateError [ECONNREFUSED]: 
      at internalConnectMultiple (node:net:1139:18)
      at afterConnectMultiple (node:net:1714:7)
      at TCPConnectWrap.callbackTrampoline (node:internal/async_hooks:130:17) {
    code: 'ECONNREFUSED',
    [errors]: [ [Error], [Error] ]
  }
}
 POST /api/ai/edit-mode/generate 200 in 581ms
[Error: ENOENT: no such file or directory, stat '/Users/matthewfitzpatrick/pinnlo-v2/.next/cache/webpack/server-development/4.pack.gz'] {
  errno: -2,
  code: 'ENOENT',
  syscall: 'stat',
  path: '/Users/matthewfitzpatrick/pinnlo-v2/.next/cache/webpack/server-development/4.pack.gz'
}
 ‚®Ø unhandledRejection: [Error: ENOENT: no such file or directory, stat '/Users/matthewfitzpatrick/pinnlo-v2/.next/cache/webpack/server-development/4.pack.gz'] {
  errno: -2,
  code: 'ENOENT',
  syscall: 'stat',
  path: '/Users/matthewfitzpatrick/pinnlo-v2/.next/cache/webpack/server-development/4.pack.gz'
}
 ‚®Ø unhandledRejection: [Error: ENOENT: no such file or directory, stat '/Users/matthewfitzpatrick/pinnlo-v2/.next/cache/webpack/server-development/4.pack.gz'] {
  errno: -2,
  code: 'ENOENT',
  syscall: 'stat',
  path: '/Users/matthewfitzpatrick/pinnlo-v2/.next/cache/webpack/server-development/4.pack.gz'
}
<w> [webpack.cache.PackFileCacheStrategy] Caching failed for pack: Error: ENOENT: no such file or directory, stat '/Users/matthewfitzpatrick/pinnlo-v2/.next/cache/webpack/server-development/4.pack.gz'
Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.
 ‚úì Compiled /_not-found in 148ms (1372 modules)
Supabase URL: Set
Supabase Anon Key: Set
 POST /api/ai/edit-mode/generate 404 in 246ms
Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.
üèóÔ∏è DevelopmentBankModal Debug:
- Modal isOpen: false
- Strategies loaded: 0
- Selected strategy: None
- Loading: true
üè¶ StrategyBankModal Debug:
- Modal isOpen: false
- Strategies loaded: 0
- Selected strategy: None
- Loading: true
 GET / 200 in 107ms
 GET /_next/static/css/app/layout.css?v=1752672987115 404 in 30ms
 GET /_next/static/css/app/page.css?v=1752672987115 404 in 40ms
 GET /_next/static/chunks/app-pages-internals.js 404 in 51ms
 GET /_next/static/chunks/main-app.js?v=1752672987115 404 in 52ms
 GET /_next/static/chunks/app/page.js 404 in 55ms
 GET /_next/static/chunks/app/layout.js 404 in 43ms
Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.
 GET /.well-known/appspecific/com.chrome.devtools.json 404 in 15ms
Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.
üèóÔ∏è DevelopmentBankModal Debug:
- Modal isOpen: false
- Strategies loaded: 0
- Selected strategy: None
- Loading: true
üè¶ StrategyBankModal Debug:
- Modal isOpen: false
- Strategies loaded: 0
- Selected strategy: None
- Loading: true
 GET / 200 in 50ms
Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.
 GET /_next/static/css/app/layout.css?v=1752673013828 404 in 72ms
 GET /_next/static/css/app/page.css?v=1752673013828 404 in 68ms
 GET /_next/static/chunks/app-pages-internals.js 404 in 60ms
 GET /_next/static/chunks/main-app.js?v=1752673013828 404 in 63ms
 GET /_next/static/chunks/app/page.js 404 in 63ms
 GET /.well-known/appspecific/com.chrome.devtools.json 404 in 13ms
 GET /_next/static/chunks/app/layout.js 404 in 13ms
Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.
üèóÔ∏è DevelopmentBankModal Debug:
- Modal isOpen: false
- Strategies loaded: 0
- Selected strategy: None
- Loading: true
üè¶ StrategyBankModal Debug:
- Modal isOpen: false
- Strategies loaded: 0
- Selected strategy: None
- Loading: true
 GET / 200 in 29ms
Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.
 GET /_next/static/css/app/page.css?v=1752673015813 404 in 34ms
 GET /_next/static/css/app/layout.css?v=1752673015813 404 in 36ms
 GET /.well-known/appspecific/com.chrome.devtools.json 404 in 34ms
 GET /_next/static/chunks/main-app.js?v=1752673015813 404 in 50ms
 GET /_next/static/chunks/app-pages-internals.js 404 in 50ms
 GET /_next/static/chunks/app/page.js 404 in 42ms
 GET /_next/static/chunks/app/layout.js 404 in 9ms
Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.
üèóÔ∏è DevelopmentBankModal Debug:
- Modal isOpen: false
- Strategies loaded: 0
- Selected strategy: None
- Loading: true
üè¶ StrategyBankModal Debug:
- Modal isOpen: false
- Strategies loaded: 0
- Selected strategy: None
- Loading: true
 GET / 200 in 33ms
Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.
 GET /_next/static/css/app/page.css?v=1752673017296 404 in 37ms
 GET /_next/static/css/app/layout.css?v=1752673017296 404 in 40ms
 GET /.well-known/appspecific/com.chrome.devtools.json 404 in 42ms
 GET /_next/static/chunks/app-pages-internals.js 404 in 55ms
 GET /_next/static/chunks/main-app.js?v=1752673017296 404 in 53ms
 GET /_next/static/chunks/app/page.js 404 in 44ms
 GET /_next/static/chunks/app/layout.js 404 in 14ms
Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.
üèóÔ∏è DevelopmentBankModal Debug:
- Modal isOpen: false
- Strategies loaded: 0
- Selected strategy: None
- Loading: true
üè¶ StrategyBankModal Debug:
- Modal isOpen: false
- Strategies loaded: 0
- Selected strategy: None
- Loading: true
 GET / 200 in 58ms
 GET /_next/static/css/app/page.css?v=1752673028701 404 in 33ms
 GET /_next/static/css/app/layout.css?v=1752673028701 404 in 37ms
Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.
 GET /_next/static/chunks/main-app.js?v=1752673028701 404 in 55ms
 GET /.well-known/appspecific/com.chrome.devtools.json 404 in 9ms
 GET /_next/static/chunks/app/page.js 404 in 53ms
 GET /_next/static/chunks/app-pages-internals.js 404 in 55ms
 GET /_next/static/chunks/app/layout.js 404 in 19ms
